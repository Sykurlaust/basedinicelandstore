<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cart — basediniceland</title>
  <link href="./output.css" rel="stylesheet" />
</head>
<body class="min-h-screen bg-black overflow-x-hidden overscroll-none">
  <div class="fixed inset-0 -z-10 bg-cover bg-center bg-no-repeat"
       style="background-image: url('./images/baraglacier.jpg');"></div>

  <div class="min-h-screen relative flex flex-col">
    <!-- reuse your same glass nav HERE (copy from store.html) -->

    <main class="flex-1 pt-36 pb-16 px-6">
      <section class="mx-auto max-w-[900px]">
        <h1 class="text-3xl lg:text-5xl font-extrabold tracking-tight text-white text-center">Your cart</h1>

        <!-- Cart card -->
        <div class="mt-8 rounded-3xl p-6 lg:p-8 text-white
                    bg-gradient-to-br from-white/12 via-white/8 to-white/5
                    backdrop-blur-xl border border-white/35 ring-1 ring-white/20
                    shadow-[0_8px_30px_rgba(0,0,0,0.25)]">
          <!-- list -->
          <div id="cart-list" class="divide-y divide-white/15"></div>

          <!-- total + actions -->
          <div class="mt-6 flex items-center justify-between">
            <div class="text-white/90">
              <span class="mr-2">Items:</span><span id="cart-items-count">0</span>
              <span class="ml-6 mr-2">Total:</span><span id="cart-total">ISK 0</span>
            </div>
            <div class="flex gap-3">
              <button id="btn-clear"
                class="px-4 py-2 rounded-full bg-white/15 hover:bg-white/25 transition">Clear</button>
              <button
                class="px-4 py-2 rounded-full bg-white/25 text-slate-900 font-semibold hover:bg-white/35 transition">
                Checkout
              </button>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="./js/cart.js"></script>
  <script>
    // --- Render list using the same storage the buttons use ---
    (function () {
      'use strict';
      const listEl = document.getElementById('cart-list');
      const totalEl = document.getElementById('cart-total');
      const itemsCountEl = document.getElementById('cart-items-count');
      const btnClear = document.getElementById('btn-clear');

      function getCart(){ try{return JSON.parse(localStorage.getItem('bi_cart')||'[]')}catch{ return [] } }
      function saveCart(c){ localStorage.setItem('bi_cart', JSON.stringify(c)); }

      function render(){
        const cart = getCart();
        listEl.innerHTML = '';

        // build each row
        cart.forEach((item, i) => {
          const row = document.createElement('div');
          row.className = 'py-3 flex items-center justify-between';
          row.innerHTML = `
            <div>
              <div class="font-semibold">${item.name}</div>
              <div class="text-white/70 text-sm">ISK ${item.price.toLocaleString('is-IS')} × ${item.qty}</div>
            </div>
            <div class="flex items-center gap-3">
              <span>ISK ${(item.price*item.qty).toLocaleString('is-IS')}</span>
              <button data-index="${i}"
                class="btn-remove rounded-full px-3 py-1 bg-white/15 hover:bg-white/25">Remove</button>
            </div>
          `;
          listEl.appendChild(row);
        });

        const items = cart.reduce((n, it) => n + it.qty, 0);
        const total = cart.reduce((s, it) => s + it.price * it.qty, 0);

        itemsCountEl.textContent = items;
        totalEl.textContent = `ISK ${total.toLocaleString('is-IS')}`;

        // wire remove buttons
        listEl.querySelectorAll('.btn-remove').forEach(btn=>{
          btn.addEventListener('click', () => {
            const idx = Number(btn.dataset.index);
            const c = getCart();
            c.splice(idx, 1);         // remove that item
            saveCart(c);
            render();
            // badge on nav will auto-update because cart.js listens to storage change (same tab)
            if (window.updateCartBadge) updateCartBadge();
          });
        });
      }

      btnClear.addEventListener('click', () => {
        saveCart([]);
        render();
        if (window.updateCartBadge) updateCartBadge();
      });

      render();
    })();
  </script>
</body>
</html>
